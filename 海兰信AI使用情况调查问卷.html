<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ·å…°ä¿¡AIåº”ç”¨è°ƒæŸ¥é—®å·ç³»ç»Ÿ - å®Œæ•´ç‰ˆ</title>
    <!-- å¼•å…¥EChartsåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.0/dist/echarts.min.js"></script>
    <!-- å¼•å…¥QRCodeåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- å¼•å…¥html2pdfåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1F4E78 0%, #2E5C8A 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .header-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .header-stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .header-stat-value {
            font-size: 24px;
            font-weight: 700;
        }

        .header-stat-label {
            font-size: 12px;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 2px solid #ddd;
            flex-wrap: wrap;
        }

        .tab-button {
            flex: 1;
            min-width: 120px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: white;
            color: #4472C4;
            border-bottom: 3px solid #4472C4;
            margin-bottom: -2px;
        }

        .tab-button:hover {
            color: #4472C4;
        }

        .content {
            padding: 40px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            background: #4472C4;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: #FFD700;
            margin-right: 10px;
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 25px;
            padding: 15px;
            background: #f9f9f9;
            border-left: 4px solid #4472C4;
            border-radius: 4px;
        }

        .form-group label {
            display: block;
            font-weight: 700;
            margin-bottom: 12px;
            color: #333;
            font-size: 14px;
        }

        .form-group label .question-num {
            color: #4472C4;
            margin-right: 5px;
        }

        .checkbox-group,
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item,
        .radio-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkbox-item:hover,
        .radio-item:hover {
            background: #e8f0f8;
        }

        input[type="checkbox"],
        input[type="radio"] {
            margin-right: 8px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        input[type="text"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
            margin-top: 8px;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #4472C4;
            box-shadow: 0 0 0 3px rgba(68, 114, 196, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .input-inline {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .input-inline input {
            flex: 1;
            min-width: 100px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 40px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 30px;
            font-size: 16px;
            font-weight: 700;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-submit {
            background: linear-gradient(135deg, #4472C4 0%, #2E5C8A 100%);
            color: white;
            min-width: 120px;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(68, 114, 196, 0.3);
        }

        .btn-reset {
            background: #f0f0f0;
            color: #333;
            min-width: 120px;
        }

        .btn-reset:hover {
            background: #e0e0e0;
        }

        .btn-export {
            background: #28a745;
            color: white;
            min-width: 120px;
        }

        .btn-export:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-qrcode {
            background: #17a2b8;
            color: white;
            min-width: 120px;
        }

        .btn-qrcode:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            min-width: 120px;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .error-message {
            display: none;
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }

        .required {
            color: #dc3545;
            font-weight: 700;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
        }

        .info-box strong {
            color: #2196F3;
        }

        .form-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .info-item {
            background: #f0f5f9;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #4472C4;
        }

        .info-item label {
            display: block;
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .info-item input,
        .info-item select {
            margin-top: 5px;
        }

        .footer {
            background: #f9f9f9;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 12px;
            border-top: 1px solid #eee;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: 700;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .chart-container h3 {
            margin-bottom: 20px;
            color: #333;
            font-size: 16px;
        }

        .chart {
            width: 100%;
            height: 400px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th {
            background: #4472C4;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        .data-table tr:hover {
            background: #f5f5f5;
        }

        .share-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .share-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            border: 2px solid #4472C4;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .share-card h3 {
            color: #4472C4;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .qrcode-container {
            background: white;
            padding: 15px;
            border-radius: 8px;
            display: inline-block;
            margin: 15px 0;
            border: 1px solid #ddd;
        }

        #qrcode {
            display: inline-block;
        }

        .link-display {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 4px;
            margin: 12px 0;
            word-break: break-all;
            color: #4472C4;
            font-weight: 600;
            font-size: 13px;
        }

        .copy-btn {
            background: #4472C4;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 12px;
            font-weight: 600;
        }

        .copy-btn:hover {
            background: #2E5C8A;
        }

        .password-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            color: #856404;
            font-size: 13px;
        }

        .password-warning strong {
            color: #d39e00;
        }

        @media (max-width: 768px) {
            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 20px;
            }

            .content {
                padding: 20px;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .tabs {
                flex-direction: column;
            }

            .chart {
                height: 300px;
            }

            .header-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ æµ·å…°ä¿¡æ™ºèƒ½æµ·äº‹äº‹ä¸šéƒ¨</h1>
            <h2 style="font-size: 18px; font-weight: 400;">AIåº”ç”¨ç°çŠ¶è°ƒæŸ¥é—®å·ç³»ç»Ÿ</h2>
            <p>å®Œæ•´çš„åœ¨çº¿é—®å·ã€æ•°æ®åˆ†æã€æŠ¥å‘Šç”Ÿæˆç³»ç»Ÿ</p>
            <div class="header-stats">
                <div class="header-stat">
                    <div class="header-stat-value" id="headerTotalResponses">0</div>
                    <div class="header-stat-label">æ€»å›å¤æ•°</div>
                </div>
                <div class="header-stat">
                    <div class="header-stat-value" id="headerDepartmentCount">0</div>
                    <div class="header-stat-label">éƒ¨é—¨è¦†ç›–</div>
                </div>
                <div class="header-stat">
                    <div class="header-stat-value" id="headerAiRate">0%</div>
                    <div class="header-stat-label">AIåº”ç”¨ç‡</div>
                </div>
                <div class="header-stat">
                    <div class="header-stat-value" id="headerMaturity">0</div>
                    <div class="header-stat-label">å¹³å‡æˆç†Ÿåº¦</div>
                </div>
            </div>
        </div>

        <!-- æ ‡ç­¾é¡µ -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('survey')">ğŸ“ é—®å·å¡«å†™</button>
            <button class="tab-button" onclick="switchTab('analysis')">ğŸ“Š æ•°æ®åˆ†æ</button>
            <button class="tab-button" onclick="switchTab('report')">ğŸ“„ ç”ŸæˆæŠ¥å‘Š</button>
            <button class="tab-button" onclick="switchTab('share')">ğŸ”— åˆ†äº«é—®å·</button>
        </div>

        <div class="content">
            <!-- æ ‡ç­¾é¡µ1ï¼šé—®å·å¡«å†™ -->
            <div id="survey" class="tab-content active">
                <div id="successMessage" class="success-message">
                    âœ… é—®å·æäº¤æˆåŠŸï¼æ„Ÿè°¢æ‚¨çš„å‚ä¸ã€‚
                </div>

                <div id="errorMessage" class="error-message">
                    âŒ è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹
                </div>

                <div class="info-box">
                    <strong>ğŸ“‹ å¡«å†™è¯´æ˜ï¼š</strong> æœ¬é—®å·é‡‡ç”¨åŒ¿åæ–¹å¼ï¼Œæ‰€æœ‰æ•°æ®ä»…ç”¨äºAIæˆ˜ç•¥åˆ†æï¼Œä¸æ¶‰åŠä¸ªäººéšç§ã€‚é¢„è®¡å¡«å†™æ—¶é—´8-10åˆ†é’Ÿã€‚
                </div>

                <div class="form-info">
                    <div class="info-item">
                        <label>å¡«å†™æ—¥æœŸ</label>
                        <input type="date" id="surveyDate" required>
                    </div>
                    <div class="info-item">
                        <label>æ‚¨çš„éƒ¨é—¨ <span class="required">*</span></label>
                        <select id="department" required>
                            <option value="">-- è¯·é€‰æ‹© --</option>
                            <option value="ç»è¥ä¸­å¿ƒ">ç»è¥ä¸­å¿ƒ</option>
                            <option value="é›†æˆä¸šåŠ¡ä¸­å¿ƒ">é›†æˆä¸šåŠ¡ä¸­å¿ƒ</option>
                            <option value="æœåŠ¡å…¬å¸">æœåŠ¡å…¬å¸</option>
                            <option value="è¿è¥ç®¡ç†ä¸­å¿ƒ">è¿è¥ç®¡ç†ä¸­å¿ƒ</option>
                            <option value="è´¨é‡éƒ¨">è´¨é‡éƒ¨</option>
                            <option value="äº§å“ä¸­å¿ƒ">äº§å“ä¸­å¿ƒ</option>
                            <option value="é›·è¾¾ç ”ç©¶é™¢">é›·è¾¾ç ”ç©¶é™¢</option>
                            <option value="å¯¼èˆªç ”å‘ä¸­å¿ƒ">å¯¼èˆªç ”å‘ä¸­å¿ƒ</option>
                            <option value="åˆ›æ–°ä¸­å¿ƒ">åˆ›æ–°ä¸­å¿ƒ</option>
                        </select>
                    </div>
                    <div class="info-item">
                        <label>æ‚¨çš„èŒä½çº§åˆ« <span class="required">*</span></label>
                        <select id="position" required>
                            <option value="">-- è¯·é€‰æ‹© --</option>
                            <option value="é«˜å±‚ç®¡ç†">é«˜å±‚ç®¡ç†</option>
                            <option value="ä¸­å±‚ç®¡ç†">ä¸­å±‚ç®¡ç†</option>
                            <option value="æŠ€æœ¯äººå‘˜">æŠ€æœ¯äººå‘˜</option>
                            <option value="ä¸šåŠ¡äººå‘˜">ä¸šåŠ¡äººå‘˜</option>
                        </select>
                    </div>
                </div>

                <form id="surveyForm">
                    <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºæœ¬ä¿¡æ¯ -->
                    <div class="section">
                        <div class="section-title">ç¬¬ä¸€éƒ¨åˆ†ï¼šåŸºæœ¬ä¿¡æ¯</div>

                        <div class="form-group">
                            <label><span class="question-num">1.</span>æ‚¨åœ¨æµ·å…°ä¿¡çš„å·¥ä½œå¹´é™ <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-item">
                                    <input type="radio" name="workYears" value="1å¹´ä»¥å†…" required>
                                    <span>1å¹´ä»¥å†…</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="workYears" value="1-3å¹´" required>
                                    <span>1-3å¹´</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="workYears" value="3-5å¹´" required>
                                    <span>3-5å¹´</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="workYears" value="5å¹´ä»¥ä¸Š" required>
                                    <span>5å¹´ä»¥ä¸Š</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šAIåº”ç”¨ç°çŠ¶ -->
                    <div class="section">
                        <div class="section-title">ç¬¬äºŒéƒ¨åˆ†ï¼šAIåº”ç”¨ç°çŠ¶</div>

                        <div class="form-group">
                            <label><span class="question-num">2.</span>è´µéƒ¨é—¨å·²åº”ç”¨çš„AIæŠ€æœ¯ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="aiTechs" value="æœºå™¨å­¦ä¹ ">
                                    <span>æœºå™¨å­¦ä¹ </span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="aiTechs" value="è‡ªç„¶è¯­è¨€å¤„ç†(NLP)">
                                    <span>è‡ªç„¶è¯­è¨€å¤„ç†(NLP)</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="aiTechs" value="è®¡ç®—æœºè§†è§‰">
                                    <span>è®¡ç®—æœºè§†è§‰</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="aiTechs" value="é¢„æµ‹åˆ†æ">
                                    <span>é¢„æµ‹åˆ†æ</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="aiTechs" value="æœªåº”ç”¨">
                                    <span>æœªåº”ç”¨</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">3.</span>ä¸»è¦åº”ç”¨ä¸šåŠ¡åœºæ™¯ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="scenarios" value="ç¼–å†™ç¨‹åºä»£ç ï¼Œæé«˜ç ”å‘æ•ˆç‡">
                                    <span>ç¼–å†™ç¨‹åºä»£ç ï¼Œæé«˜ç ”å‘æ•ˆç‡</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="scenarios" value="å¢åŠ å®¢æˆ·çš„è·å–æ•°é‡ï¼Œåˆ†æå¸‚åœºå’Œé”€å”®æ•°æ®">
                                    <span>å¢åŠ å®¢æˆ·çš„è·å–æ•°é‡ï¼Œåˆ†æå¸‚åœºå’Œé”€å”®æ•°æ®</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="scenarios" value="æé«˜è´¨é‡ç®¡ç†æ°´å¹³">
                                    <span>æé«˜è´¨é‡ç®¡ç†æ°´å¹³</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="scenarios" value="é™ä½é‡‡è´­æˆæœ¬">
                                    <span>é™ä½é‡‡è´­æˆæœ¬</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="scenarios" value="å¢åŠ ç®¡ç†è€…å†³ç­–çš„é€æ˜åº¦å’Œå‡†ç¡®æ€§">
                                    <span>å¢åŠ ç®¡ç†è€…å†³ç­–çš„é€æ˜åº¦å’Œå‡†ç¡®æ€§</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="scenarios" value="å…¶ä»–">
                                    <span>å…¶ä»–</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">4.</span>AIåº”ç”¨æˆç†Ÿåº¦è¯„ä¼° <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-item">
                                    <input type="radio" name="maturity" value="æ¢ç´¢é˜¶æ®µ" required>
                                    <span>æ¢ç´¢é˜¶æ®µï¼ˆåˆšå¼€å§‹å°è¯•ï¼‰</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="maturity" value="è¯•ç‚¹é˜¶æ®µ" required>
                                    <span>è¯•ç‚¹é˜¶æ®µï¼ˆå·²æœ‰è¯•ç‚¹é¡¹ç›®ï¼‰</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="maturity" value="åº”ç”¨é˜¶æ®µ" required>
                                    <span>åº”ç”¨é˜¶æ®µï¼ˆå·²åœ¨ä¸šåŠ¡ä¸­åº”ç”¨ï¼‰</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="maturity" value="æˆç†Ÿè¿è¥" required>
                                    <span>æˆç†Ÿè¿è¥ï¼ˆå·²å½¢æˆè§„æ¨¡åº”ç”¨ï¼‰</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">5.</span>å½“å‰AIé¡¹ç›®æŠ•å…¥è§„æ¨¡ <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-item">
                                    <input type="radio" name="investment" value="æœªæŠ•å…¥" required>
                                    <span>æœªæŠ•å…¥</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="investment" value="50ä¸‡ä»¥å†…" required>
                                    <span>50ä¸‡ä»¥å†…</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="investment" value="50-200ä¸‡" required>
                                    <span>50-200ä¸‡</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="investment" value="200-500ä¸‡" required>
                                    <span>200-500ä¸‡</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="investment" value="500ä¸‡ä»¥ä¸Š" required>
                                    <span>500ä¸‡ä»¥ä¸Š</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">6.</span>AIç›¸å…³ä¸“ä¸šäººæ‰æ•°é‡</label>
                            <div class="input-inline">
                                <input type="number" name="talentCount" min="0" placeholder="è¯·è¾“å…¥äººæ•°">
                                <span style="color: #666;">äºº</span>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šåº”ç”¨æ•ˆç›Š -->
                    <div class="section">
                        <div class="section-title">ç¬¬ä¸‰éƒ¨åˆ†ï¼šåº”ç”¨æ•ˆç›Š</div>

                        <div class="form-group">
                            <label><span class="question-num">7.</span>å·²å®ç°çš„ä¸»è¦æ•ˆç›Šï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="benefits" value="ä¸šåŠ¡æ•ˆç‡æå‡">
                                    <span>ä¸šåŠ¡æ•ˆç‡æå‡</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="benefits" value="æˆæœ¬é™ä½">
                                    <span>æˆæœ¬é™ä½</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="benefits" value="å†³ç­–è´¨é‡æå‡">
                                    <span>å†³ç­–è´¨é‡æå‡</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="benefits" value="é£é™©é˜²æ§å¢å¼º">
                                    <span>é£é™©é˜²æ§å¢å¼º</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬å››éƒ¨åˆ†ï¼šå­˜åœ¨çš„é—®é¢˜ -->
                    <div class="section">
                        <div class="section-title">ç¬¬å››éƒ¨åˆ†ï¼šå­˜åœ¨çš„é—®é¢˜ä¸æŒ‘æˆ˜</div>

                        <div class="form-group">
                            <label><span class="question-num">8.</span>ä¸»è¦éšœç¢ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="obstacles" value="æ•°æ®è´¨é‡ä¸æ•°æ®é‡ä¸è¶³">
                                    <span>æ•°æ®è´¨é‡ä¸æ•°æ®é‡ä¸è¶³</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="obstacles" value="ä¸“ä¸šäººæ‰ç¼ºä¹">
                                    <span>ä¸“ä¸šäººæ‰ç¼ºä¹</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="obstacles" value="æŠ€æœ¯åŸºç¡€è®¾æ–½ä¸å®Œå–„">
                                    <span>æŠ€æœ¯åŸºç¡€è®¾æ–½ä¸å®Œå–„</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="obstacles" value="èµ„é‡‘æŠ•å…¥ä¸è¶³">
                                    <span>èµ„é‡‘æŠ•å…¥ä¸è¶³</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="obstacles" value="ç¼ºä¹ç»Ÿä¸€çš„AIæˆ˜ç•¥è§„åˆ’">
                                    <span>ç¼ºä¹ç»Ÿä¸€çš„AIæˆ˜ç•¥è§„åˆ’</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">9.</span>æ•°æ®æ–¹é¢çš„ä¸»è¦é—®é¢˜ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="dataIssues" value="æ•°æ®å­¤å²›">
                                    <span>æ•°æ®å­¤å²›ï¼Œéš¾ä»¥å…±äº«</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="dataIssues" value="æ•°æ®æ ‡å‡†ä¸ç»Ÿä¸€">
                                    <span>æ•°æ®æ ‡å‡†ä¸ç»Ÿä¸€</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="dataIssues" value="æ•°æ®è´¨é‡å‚å·®">
                                    <span>æ•°æ®è´¨é‡å‚å·®ä¸é½</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="dataIssues" value="æ²»ç†ä½“ç³»ä¸å®Œå–„">
                                    <span>æ•°æ®æ²»ç†ä½“ç³»ä¸å®Œå–„</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">10.</span>æŠ€æœ¯æ–¹é¢çš„ä¸»è¦å›°éš¾ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="techIssues" value="ç¼ºä¹è‡ªä¸»ç ”å‘èƒ½åŠ›">
                                    <span>ç¼ºä¹è‡ªä¸»ç ”å‘èƒ½åŠ›</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="techIssues" value="ç®—åŠ›èµ„æºä¸è¶³">
                                    <span>ç®—åŠ›èµ„æºä¸è¶³</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="techIssues" value="æ¨¡å‹ç²¾åº¦ä¸ç†æƒ³">
                                    <span>æ¨¡å‹ç²¾åº¦éš¾ä»¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="techIssues" value="AIç³»ç»Ÿé›†æˆå›°éš¾">
                                    <span>AIç³»ç»Ÿé›†æˆå›°éš¾</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ç¬¬äº”éƒ¨åˆ†ï¼šæˆ˜ç•¥å»ºè®® -->
                    <div class="section">
                        <div class="section-title">ç¬¬äº”éƒ¨åˆ†ï¼šæˆ˜ç•¥å»ºè®®</div>

                        <div class="form-group">
                            <label><span class="question-num">11.</span>æœ€éœ€è¦åŠ å¼ºçš„AIèƒ½åŠ›ï¼ˆå¯å¤šé€‰ï¼‰</label>
                            <div class="checkbox-group">
                                <label class="checkbox-item">
                                    <input type="checkbox" name="capabilities" value="æ•°æ®é‡‡é›†ä¸å¤„ç†">
                                    <span>æ•°æ®é‡‡é›†ä¸å¤„ç†èƒ½åŠ›</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="capabilities" value="AIç®—æ³•ç ”å‘">
                                    <span>AIç®—æ³•ç ”å‘èƒ½åŠ›</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="capabilities" value="AIåº”ç”¨å¼€å‘">
                                    <span>AIåº”ç”¨å¼€å‘èƒ½åŠ›</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="capabilities" value="äººæ‰å¼•è¿›ä¸åŸ¹å…»">
                                    <span>AIäººæ‰å¼•è¿›ä¸åŸ¹å…»</span>
                                </label>
                                <label class="checkbox-item">
                                    <input type="checkbox" name="capabilities" value="åŸºç¡€è®¾æ–½å»ºè®¾">
                                    <span>AIåŸºç¡€è®¾æ–½ï¼ˆç®—åŠ›ã€äº‘å¹³å°ç­‰ï¼‰</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">12.</span>æ¨è¿›AIæˆ˜ç•¥çš„å…³é”®å› ç´ æ’åºï¼ˆ1=æœ€å…³é”®ï¼‰</label>
                            <p style="font-size: 12px; color: #666; margin: 10px 0;">è¯·ä¸ºä»¥ä¸‹å› ç´ æ’åºï¼š</p>
                            <div style="display: grid; gap: 10px;">
                                <div class="input-inline">
                                    <input type="number" name="factor_leadership" min="1" max="5" placeholder="æ’åº" style="width: 60px;">
                                    <span>é«˜å±‚é¢†å¯¼æ”¯æŒ</span>
                                </div>
                                <div class="input-inline">
                                    <input type="number" name="factor_funding" min="1" max="5" placeholder="æ’åº" style="width: 60px;">
                                    <span>å……è¶³çš„èµ„é‡‘æŠ•å…¥</span>
                                </div>
                                <div class="input-inline">
                                    <input type="number" name="factor_talent" min="1" max="5" placeholder="æ’åº" style="width: 60px;">
                                    <span>ä¸“ä¸šäººæ‰é˜Ÿä¼</span>
                                </div>
                                <div class="input-inline">
                                    <input type="number" name="factor_data" min="1" max="5" placeholder="æ’åº" style="width: 60px;">
                                    <span>å®Œå–„çš„æ•°æ®åŸºç¡€</span>
                                </div>
                                <div class="input-inline">
                                    <input type="number" name="factor_strategy" min="1" max="5" placeholder="æ’åº" style="width: 60px;">
                                    <span>æ¸…æ™°çš„æˆ˜ç•¥è§„åˆ’</span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">13.</span>å¯¹æµ·äº‹è¡Œä¸šAIåº”ç”¨å‰æ™¯çš„çœ‹æ³•ï¼ˆ1=éå¸¸ä¹è§‚ï¼Œ5=éå¸¸æ‚²è§‚ï¼‰</label>
                            <div class="input-inline">
                                <input type="number" name="industryOutlook" min="1" max="5" placeholder="1-5" style="width: 80px;">
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">14.</span>å¯¹ç«äº‰å¯¹æ‰‹AIåº”ç”¨æ°´å¹³çš„è¯„ä¼°</label>
                            <div class="radio-group">
                                <label class="radio-item">
                                    <input type="radio" name="competitivePosition" value="é¢†å…ˆäºæˆ‘ä»¬">
                                    <span>é¢†å…ˆäºæˆ‘ä»¬</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="competitivePosition" value="ä¸æˆ‘ä»¬ç›¸å½“">
                                    <span>ä¸æˆ‘ä»¬ç›¸å½“</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="competitivePosition" value="è½åäºæˆ‘ä»¬">
                                    <span>è½åäºæˆ‘ä»¬</span>
                                </label>
                                <label class="radio-item">
                                    <input type="radio" name="competitivePosition" value="ä¸æ¸…æ¥š">
                                    <span>ä¸æ¸…æ¥š</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label><span class="question-num">15.</span>å¯¹å…¬å¸AIæˆ˜ç•¥çš„å…¶ä»–å»ºè®®</label>
                            <textarea name="otherSuggestions" placeholder="è¯·è¾“å…¥æ‚¨çš„å»ºè®®..."></textarea>
                        </div>
                    </div>

                    <!-- æŒ‰é’®ç»„ -->
                    <div class="button-group">
                        <button type="submit" class="btn-submit">âœ… æäº¤é—®å·</button>
                        <button type="reset" class="btn-reset">ğŸ”„ æ¸…ç©ºé‡å¡«</button>
                    </div>
                </form>
            </div>

            <!-- æ ‡ç­¾é¡µ2ï¼šæ•°æ®åˆ†æ -->
            <div id="analysis" class="tab-content">
                <div class="info-box">
                    <strong>ğŸ“Š æ•°æ®åˆ†æï¼š</strong> å®æ—¶å±•ç¤ºæ‰€æœ‰å·²æäº¤é—®å·çš„ç»Ÿè®¡åˆ†æç»“æœã€‚
                </div>

                <!-- ç»Ÿè®¡å¡ç‰‡ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>æ€»å›å¤æ•°</h3>
                        <div class="value" id="totalResponses">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>éƒ¨é—¨è¦†ç›–</h3>
                        <div class="value" id="departmentCount">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>AIåº”ç”¨ç‡</h3>
                        <div class="value" id="aiAdoptionRate">0%</div>
                    </div>
                    <div class="stat-card">
                        <h3>å¹³å‡æˆç†Ÿåº¦</h3>
                        <div class="value" id="avgMaturity">0</div>
                    </div>
                </div>

                <!-- å›¾è¡¨1ï¼šéƒ¨é—¨åˆ†å¸ƒ -->
                <div class="chart-container">
                    <h3>ğŸ“ éƒ¨é—¨åˆ†å¸ƒ</h3>
                    <div id="departmentChart" class="chart"></div>
                </div>

                <!-- å›¾è¡¨2ï¼šAIæŠ€æœ¯åº”ç”¨ -->
                <div class="chart-container">
                    <h3>ğŸ¤– AIæŠ€æœ¯åº”ç”¨æƒ…å†µ</h3>
                    <div id="aiTechChart" class="chart"></div>
                </div>

                <!-- å›¾è¡¨3ï¼šä¸šåŠ¡åœºæ™¯åº”ç”¨ -->
                <div class="chart-container">
                    <h3>ğŸ¯ ä¸šåŠ¡åœºæ™¯åº”ç”¨æƒ…å†µ</h3>
                    <div id="scenarioChart" class="chart"></div>
                </div>

                <!-- å›¾è¡¨4ï¼šæˆç†Ÿåº¦åˆ†å¸ƒ -->
                <div class="chart-container">
                    <h3>ğŸ“ˆ æˆç†Ÿåº¦åˆ†å¸ƒ</h3>
                    <div id="maturityChart" class="chart"></div>
                </div>

                <!-- å›¾è¡¨5ï¼šæŠ•å…¥è§„æ¨¡ -->
                <div class="chart-container">
                    <h3>ğŸ’° æŠ•å…¥è§„æ¨¡åˆ†å¸ƒ</h3>
                    <div id="investmentChart" class="chart"></div>
                </div>

                <!-- å›¾è¡¨6ï¼šä¸»è¦éšœç¢ -->
                <div class="chart-container">
                    <h3>âš ï¸ ä¸»è¦éšœç¢æ’åº</h3>
                    <div id="obstaclesChart" class="chart"></div>
                </div>

                <!-- è¡¨æ ¼ï¼šåŸå§‹æ•°æ® -->
                <div class="chart-container">
                    <h3>ğŸ“‹ åŸå§‹æ•°æ®è¡¨</h3>
                    <table class="data-table" id="dataTable">
                        <thead>
                            <tr>
                                <th>åºå·</th>
                                <th>éƒ¨é—¨</th>
                                <th>èŒä½</th>
                                <th>å·¥ä½œå¹´é™</th>
                                <th>AIæŠ€æœ¯</th>
                                <th>åº”ç”¨åœºæ™¯</th>
                                <th>æˆç†Ÿåº¦</th>
                                <th>æŠ•å…¥è§„æ¨¡</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- æ ‡ç­¾é¡µ3ï¼šç”ŸæˆæŠ¥å‘Š -->
            <div id="report" class="tab-content">
                <div class="info-box">
                    <strong>ğŸ“„ æŠ¥å‘Šç®¡ç†ï¼š</strong> ç”ŸæˆPDFæŠ¥å‘Šã€å¯¼å‡ºæ•°æ®ã€åŠ è½½ç¤ºä¾‹æ•°æ®æˆ–æ¸…ç©ºæ‰€æœ‰æ•°æ®ã€‚
                </div>

                <!-- å¯†ç ä¿æŠ¤æç¤º -->
                <div class="password-warning">
                    <strong>ğŸ”’ å®‰å…¨æç¤ºï¼š</strong> "æ¸…ç©ºæ‰€æœ‰æ•°æ®"åŠŸèƒ½å·²å¯ç”¨å¯†ç ä¿æŠ¤ã€‚å¯†ç ä¸º <strong>123456</strong>ï¼ˆä»…ç”¨äºé˜²æ­¢è¯¯æ“ä½œï¼‰
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 30px;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer;" onclick="generatePDFReport()">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“„</div>
                        <h3 style="margin-bottom: 10px; font-size: 18px;">ç”ŸæˆPDFæŠ¥å‘Š</h3>
                        <p style="opacity: 0.9; font-size: 14px;">ç”Ÿæˆå®Œæ•´çš„åˆ†ææŠ¥å‘Šå¹¶ä¸‹è½½ä¸ºPDF</p>
                    </div>

                    <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer;" onclick="exportToJSON()">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“Š</div>
                        <h3 style="margin-bottom: 10px; font-size: 18px;">å¯¼å‡ºJSONæ•°æ®</h3>
                        <p style="opacity: 0.9; font-size: 14px;">å¯¼å‡ºæ‰€æœ‰é—®å·æ•°æ®ä¸ºJSONæ ¼å¼</p>
                    </div>

                    <div style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: white; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer;" onclick="exportToCSV()">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“ˆ</div>
                        <h3 style="margin-bottom: 10px; font-size: 18px;">å¯¼å‡ºCSVæ•°æ®</h3>
                        <p style="opacity: 0.9; font-size: 14px;">å¯¼å‡ºæ‰€æœ‰é—®å·æ•°æ®ä¸ºCSVæ ¼å¼</p>
                    </div>

                    <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer;" onclick="downloadSampleData()">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“¥</div>
                        <h3 style="margin-bottom: 10px; font-size: 18px;">ä¸‹è½½ç¤ºä¾‹æ•°æ®</h3>
                        <p style="opacity: 0.9; font-size: 14px;">ä¸‹è½½ç¤ºä¾‹æ•°æ®ç”¨äºæµ‹è¯•å’Œæ¼”ç¤º</p>
                    </div>

                    <div style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 30px; border-radius: 8px; text-align: center; cursor: pointer;" onclick="clearAllData()">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ—‘ï¸</div>
                        <h3 style="margin-bottom: 10px; font-size: 18px;">æ¸…ç©ºæ‰€æœ‰æ•°æ®</h3>
                        <p style="opacity: 0.9; font-size: 14px;">åˆ é™¤æœ¬åœ°å­˜å‚¨çš„æ‰€æœ‰é—®å·æ•°æ®ï¼ˆéœ€è¦å¯†ç ï¼‰</p>
                    </div>
                </div>
            </div>

            <!-- æ ‡ç­¾é¡µ4ï¼šåˆ†äº«é—®å· -->
            <div id="share" class="tab-content">
                <div class="info-box">
                    <strong>ğŸ”— åˆ†äº«é—®å·ï¼š</strong> ç”ŸæˆäºŒç»´ç å’ŒçŸ­é“¾æ¥ï¼Œæ–¹ä¾¿åŒäº‹è®¿é—®å’Œå¡«å†™é—®å·ã€‚
                </div>

                <div class="section">
                    <div class="section-title">ç”Ÿæˆåˆ†äº«é“¾æ¥</div>

                    <div class="form-group">
                        <label>é—®å·é“¾æ¥</label>
                        <input type="text" id="shareUrl" placeholder="è‡ªåŠ¨æ£€æµ‹å½“å‰é“¾æ¥" value="">
                        <button class="btn-qrcode" onclick="autoDetectUrl()" style="margin-top: 10px;">ğŸ” è‡ªåŠ¨æ£€æµ‹</button>
                    </div>

                    <div class="form-group">
                        <label>éƒ¨é—¨/ç”¨é€”æ ‡ç­¾</label>
                        <input type="text" id="shareLabel" placeholder="ä¾‹å¦‚ï¼šç»è¥ä¸­å¿ƒ" value="å…¨å…¬å¸">
                    </div>

                    <div class="button-group">
                        <button class="btn-qrcode" onclick="generateShareQRCode()">ğŸ“± ç”ŸæˆäºŒç»´ç </button>
                        <button class="btn-export" onclick="generateShareLink()">ğŸ”— ç”ŸæˆçŸ­é“¾æ¥</button>
                    </div>
                </div>

                <!-- åˆ†äº«ç»“æœ -->
                <div id="shareResult" style="display: none;">
                    <div class="share-grid">
                        <!-- äºŒç»´ç å¡ç‰‡ -->
                        <div class="share-card">
                            <h3>ğŸ“± äºŒç»´ç åˆ†äº«</h3>
                            <p style="color: #666; font-size: 13px; margin-bottom: 15px;">ç”¨æ‰‹æœºæ‰«æäºŒç»´ç å³å¯è®¿é—®é—®å·</p>
                            <div class="qrcode-container">
                                <div id="qrcode"></div>
                            </div>
                            <div class="button-group" style="margin-top: 15px;">
                                <button class="btn-qrcode" onclick="downloadShareQRCode()">ğŸ“¥ ä¸‹è½½äºŒç»´ç </button>
                                <button class="btn-export" onclick="printShareQRCode()">ğŸ–¨ï¸ æ‰“å°äºŒç»´ç </button>
                            </div>
                        </div>

                        <!-- é“¾æ¥å¡ç‰‡ -->
                        <div class="share-card">
                            <h3>ğŸ”— é“¾æ¥åˆ†äº«</h3>
                            <p style="color: #666; font-size: 13px; margin-bottom: 15px;">å¤åˆ¶é“¾æ¥åˆ†äº«ç»™åŒäº‹</p>
                            <div class="link-display" id="shareUrlDisplay"></div>
                            <button class="copy-btn" onclick="copyShareUrl()">ğŸ“‹ å¤åˆ¶é“¾æ¥</button>
                            <div class="link-display" id="shareShortDisplay" style="display: none; margin-top: 15px;"></div>
                            <button class="copy-btn" id="copyShortBtn" onclick="copyShareShortUrl()" style="display: none;">ğŸ“‹ å¤åˆ¶çŸ­é“¾æ¥</button>
                        </div>

                        <!-- åˆ†äº«å»ºè®® -->
                        <div class="share-card">
                            <h3>ğŸ’¡ åˆ†äº«å»ºè®®</h3>
                            <p style="color: #666; font-size: 13px; line-height: 1.8;">
                                âœ… é‚®ä»¶åˆ†äº«ï¼šåœ¨é‚®ä»¶ä¸­åŒ…å«äºŒç»´ç å’Œé“¾æ¥<br>
                                âœ… é’‰é’‰åˆ†äº«ï¼šå‘é€äºŒç»´ç å’ŒçŸ­é“¾æ¥<br>
                                âœ… æµ·æŠ¥åˆ†äº«ï¼šæ‰“å°äºŒç»´ç è´´åœ¨åŠå…¬åŒº<br>
                                âœ… ç­¾ååˆ†äº«ï¼šåœ¨é‚®ä»¶ç­¾åä¸­æ·»åŠ äºŒç»´ç <br>
                                âœ… å®šæœŸæé†’ï¼šæ¯å‘¨å‘é€ä¸€æ¬¡æé†’
                            </p>
                        </div>
                    </div>
                </div>

                <!-- æ‰¹é‡ç”Ÿæˆ -->
                <div class="section" style="margin-top: 40px;">
                    <div class="section-title">æ‰¹é‡ç”Ÿæˆåˆ†äº«é“¾æ¥</div>

                    <div class="form-group">
                        <label>éƒ¨é—¨åˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</label>
                        <textarea id="batchDepartments" placeholder="ä¾‹å¦‚:
ç»è¥ä¸­å¿ƒ
é›†æˆä¸šåŠ¡ä¸­å¿ƒ
æœåŠ¡å…¬å¸
è¿è¥ç®¡ç†ä¸­å¿ƒ
è´¨é‡éƒ¨" style="min-height: 150px;">ç»è¥ä¸­å¿ƒ
é›†æˆä¸šåŠ¡ä¸­å¿ƒ
æœåŠ¡å…¬å¸
è¿è¥ç®¡ç†ä¸­å¿ƒ
è´¨é‡éƒ¨
äº§å“ä¸­å¿ƒ
é›·è¾¾ç ”ç©¶é™¢
å¯¼èˆªç ”å‘ä¸­å¿ƒ
åˆ›æ–°ä¸­å¿ƒ</textarea>
                    </div>

                    <div class="button-group">
                        <button class="btn-qrcode" onclick="generateBatchQRCodes()">ğŸ“± æ‰¹é‡ç”ŸæˆäºŒç»´ç </button>
                        <button class="btn-export" onclick="downloadBatchQRCodes()">ğŸ“¥ ä¸‹è½½æ‰€æœ‰äºŒç»´ç </button>
                    </div>
                </div>

                <div id="batchResult" style="display: none; margin-top: 30px;">
                    <div class="section-title">æ‰¹é‡ç”Ÿæˆç»“æœ</div>
                    <div id="batchResultContent"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Â© 2024 æµ·å…°ä¿¡æ™ºèƒ½æµ·äº‹äº‹ä¸šéƒ¨ | å®Œæ•´çš„åœ¨çº¿é—®å·ç³»ç»Ÿ</p>
            <p>æ”¯æŒï¼šé—®å·å¡«å†™ | æ•°æ®åˆ†æ | PDFæŠ¥å‘Š | åˆ†äº«é“¾æ¥ | å¯†ç ä¿æŠ¤</p>
        </div>
    </div>

    <script>
        // ==================== åˆå§‹åŒ– ====================
        document.getElementById('surveyDate').valueAsDate = new Date();
        updateHeaderStats();

        // ==================== æ ‡ç­¾é¡µåˆ‡æ¢ ====================
        function switchTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => button.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'analysis') {
                refreshAnalysis();
            } else if (tabName === 'share') {
                autoDetectUrl();
            }
        }

        // ==================== è¡¨å•æäº¤ ====================
        document.getElementById('surveyForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const requiredFields = document.querySelectorAll('[required]');
            let isValid = true;

            for (let field of requiredFields) {
                if (!field.value) {
                    isValid = false;
                    break;
                }
            }

            if (!isValid) {
                document.getElementById('errorMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('errorMessage').style.display = 'none';
                }, 3000);
                return;
            }

            const formData = new FormData(this);
            const data = {
                department: document.getElementById('department').value,
                position: document.getElementById('position').value,
                surveyDate: document.getElementById('surveyDate').value,
            };

            const aiTechs = [];
            const scenarios = [];
            const benefits = [];
            const obstacles = [];
            const dataIssues = [];
            const techIssues = [];
            const capabilities = [];

            for (let [key, value] of formData.entries()) {
                if (key === 'aiTechs') aiTechs.push(value);
                else if (key === 'scenarios') scenarios.push(value);
                else if (key === 'benefits') benefits.push(value);
                else if (key === 'obstacles') obstacles.push(value);
                else if (key === 'dataIssues') dataIssues.push(value);
                else if (key === 'techIssues') techIssues.push(value);
                else if (key === 'capabilities') capabilities.push(value);
                else if (!(key in data)) {
                    data[key] = value;
                }
            }

            if (aiTechs.length > 0) data.aiTechs = aiTechs;
            if (scenarios.length > 0) data.scenarios = scenarios;
            if (benefits.length > 0) data.benefits = benefits;
            if (obstacles.length > 0) data.obstacles = obstacles;
            if (dataIssues.length > 0) data.dataIssues = dataIssues;
            if (techIssues.length > 0) data.techIssues = techIssues;
            if (capabilities.length > 0) data.capabilities = capabilities;

            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            responses.push({
                id: responses.length + 1,
                timestamp: new Date().toISOString(),
                data: data
            });
            localStorage.setItem('surveyResponses', JSON.stringify(responses));

            document.getElementById('successMessage').style.display = 'block';
            updateHeaderStats();

            setTimeout(() => {
                this.reset();
                document.getElementById('surveyDate').valueAsDate = new Date();
                document.getElementById('successMessage').style.display = 'none';
            }, 3000);
        });

        // ==================== æ¸…é™¤å›¾è¡¨å‡½æ•° ====================
        function clearAllCharts() {
            try {
                const deptChart = echarts.getInstanceByDom(document.getElementById('departmentChart'));
                if (deptChart) deptChart.dispose();
            } catch(e) {}
            
            try {
                const aiTechChart = echarts.getInstanceByDom(document.getElementById('aiTechChart'));
                if (aiTechChart) aiTechChart.dispose();
            } catch(e) {}
            
            try {
                const scenarioChart = echarts.getInstanceByDom(document.getElementById('scenarioChart'));
                if (scenarioChart) scenarioChart.dispose();
            } catch(e) {}
            
            try {
                const maturityChart = echarts.getInstanceByDom(document.getElementById('maturityChart'));
                if (maturityChart) maturityChart.dispose();
            } catch(e) {}
            
            try {
                const investmentChart = echarts.getInstanceByDom(document.getElementById('investmentChart'));
                if (investmentChart) investmentChart.dispose();
            } catch(e) {}
            
            try {
                const obstaclesChart = echarts.getInstanceByDom(document.getElementById('obstaclesChart'));
                if (obstaclesChart) obstaclesChart.dispose();
            } catch(e) {}
        }

        function showDeleteSuccessMessage() {
            const msg = document.createElement('div');
            msg.className = 'success-message show';
            msg.textContent = 'âœ… æ‰€æœ‰æ•°æ®å·²æˆåŠŸåˆ é™¤ï¼';
            msg.style.position = 'fixed';
            msg.style.top = '20px';
            msg.style.right = '20px';
            msg.style.zIndex = '9999';
            msg.style.minWidth = '300px';
            document.body.appendChild(msg);

            setTimeout(() => {
                msg.remove();
            }, 3000);
        }

        function showErrorMessage(message) {
            const msg = document.createElement('div');
            msg.className = 'success-message show';
            msg.textContent = message;
            msg.style.background = '#f8d7da';
            msg.style.color = '#721c24';
            msg.style.borderColor = '#f5c6cb';
            msg.style.position = 'fixed';
            msg.style.top = '20px';
            msg.style.right = '20px';
            msg.style.zIndex = '9999';
            msg.style.minWidth = '300px';
            document.body.appendChild(msg);

            setTimeout(() => {
                msg.remove();
            }, 3000);
        }

        function showLoadSampleMessage() {
            const msg = document.createElement('div');
            msg.className = 'success-message show';
            msg.textContent = 'âœ… ç¤ºä¾‹æ•°æ®å·²åŠ è½½ï¼Œè¯·åˆ‡æ¢åˆ°"æ•°æ®åˆ†æ"æ ‡ç­¾é¡µæŸ¥çœ‹';
            msg.style.position = 'fixed';
            msg.style.top = '20px';
            msg.style.right = '20px';
            msg.style.zIndex = '9999';
            msg.style.minWidth = '300px';
            document.body.appendChild(msg);

            setTimeout(() => {
                msg.remove();
            }, 3000);
        }

        // ==================== å¯†ç ä¿æŠ¤çš„æ¸…ç©ºæ•°æ®å‡½æ•° ====================
        function clearAllData() {
            const password = prompt('âš ï¸ è­¦å‘Šï¼šæ¸…ç©ºæ‰€æœ‰æ•°æ®ä¸å¯æ¢å¤ï¼\n\nè¯·è¾“å…¥å¯†ç ä»¥ç¡®è®¤æ“ä½œï¼š', '');
            
            if (password === null) {
                return;
            }
            
            if (password !== '123456') {
                showErrorMessage('âŒ å¯†ç é”™è¯¯ï¼æ“ä½œå·²å–æ¶ˆ');
                return;
            }
            
            const confirm = window.confirm('ğŸ—‘ï¸ ç¡®å®šè¦åˆ é™¤æ‰€æœ‰é—®å·æ•°æ®å—ï¼Ÿ\n\næ­¤æ“ä½œä¸å¯æ’¤é”€ï¼');
            
            if (!confirm) {
                return;
            }
            
            localStorage.removeItem('surveyResponses');
            
            document.getElementById('totalResponses').textContent = '0';
            document.getElementById('departmentCount').textContent = '0';
            document.getElementById('aiAdoptionRate').textContent = '0%';
            document.getElementById('avgMaturity').textContent = '0';
            
            document.getElementById('dataTableBody').innerHTML = '';
            
            clearAllCharts();
            
            updateHeaderStats();
            
            showDeleteSuccessMessage();
        }

        // ==================== æ•°æ®åˆ†æ ====================
        function refreshAnalysis() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');

            if (responses.length === 0) {
                alert('è¿˜æ²¡æœ‰é—®å·æ•°æ®ï¼Œè¯·å…ˆå¡«å†™é—®å·');
                return;
            }

            updateStats(responses);
            generateCharts(responses);
            generateDataTable(responses);
        }

        function updateStats(responses) {
            document.getElementById('totalResponses').textContent = responses.length;

            const departments = new Set(responses.map(r => r.data.department));
            document.getElementById('departmentCount').textContent = departments.size;

            let aiApplied = 0;
            responses.forEach(r => {
                if (r.data.aiTechs && (!Array.isArray(r.data.aiTechs) || r.data.aiTechs.length > 0)) {
                    aiApplied++;
                }
            });
            const aiRate = responses.length > 0 ? Math.round((aiApplied / responses.length) * 100) : 0;
            document.getElementById('aiAdoptionRate').textContent = aiRate + '%';

            const maturityMap = { 'æ¢ç´¢é˜¶æ®µ': 1, 'è¯•ç‚¹é˜¶æ®µ': 2, 'åº”ç”¨é˜¶æ®µ': 3, 'æˆç†Ÿè¿è¥': 4 };
            let totalMaturity = 0;
            responses.forEach(r => {
                totalMaturity += maturityMap[r.data.maturity] || 0;
            });
            const avgMaturity = responses.length > 0 ? (totalMaturity / responses.length).toFixed(1) : 0;
            document.getElementById('avgMaturity').textContent = avgMaturity;
        }

        function updateHeaderStats() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');
            
            document.getElementById('headerTotalResponses').textContent = responses.length;

            const departments = new Set(responses.map(r => r.data.department || ''));
            document.getElementById('headerDepartmentCount').textContent = departments.size;

            let aiApplied = 0;
            responses.forEach(r => {
                if (r.data.aiTechs && (!Array.isArray(r.data.aiTechs) || r.data.aiTechs.length > 0)) {
                    aiApplied++;
                }
            });
            const aiRate = responses.length > 0 ? Math.round((aiApplied / responses.length) * 100) : 0;
            document.getElementById('headerAiRate').textContent = aiRate + '%';

            const maturityMap = { 'æ¢ç´¢é˜¶æ®µ': 1, 'è¯•ç‚¹é˜¶æ®µ': 2, 'åº”ç”¨é˜¶æ®µ': 3, 'æˆç†Ÿè¿è¥': 4 };
            let totalMaturity = 0;
            responses.forEach(r => {
                totalMaturity += maturityMap[r.data.maturity] || 0;
            });
            const avgMaturity = responses.length > 0 ? (totalMaturity / responses.length).toFixed(1) : 0;
            document.getElementById('headerMaturity').textContent = avgMaturity;
        }

        function generateCharts(responses) {
            // 1. éƒ¨é—¨åˆ†å¸ƒ
            const departmentData = {};
            responses.forEach(r => {
                const dept = r.data.department;
                departmentData[dept] = (departmentData[dept] || 0) + 1;
            });

            const deptChart = echarts.init(document.getElementById('departmentChart'));
            deptChart.setOption({
                tooltip: { trigger: 'item' },
                legend: { orient: 'vertical', left: 'left' },
                series: [{
                    name: 'éƒ¨é—¨æ•°é‡',
                    type: 'pie',
                    radius: '50%',
                    data: Object.entries(departmentData).map(([name, value]) => ({ name, value })),
                    emphasis: { itemStyle: { shadowBlur: 10, shadowOffsetX: 0, shadowColor: 'rgba(0, 0, 0, 0.5)' } }
                }]
            });

            // 2. AIæŠ€æœ¯åº”ç”¨
            const aiTechData = {};
            responses.forEach(r => {
                if (r.data.aiTechs) {
                    const techs = Array.isArray(r.data.aiTechs) ? r.data.aiTechs : [r.data.aiTechs];
                    techs.forEach(tech => {
                        aiTechData[tech] = (aiTechData[tech] || 0) + 1;
                    });
                }
            });

            const aiTechChart = echarts.init(document.getElementById('aiTechChart'));
            aiTechChart.setOption({
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                xAxis: { type: 'category', data: Object.keys(aiTechData) },
                yAxis: { type: 'value' },
                series: [{
                    data: Object.values(aiTechData),
                    type: 'bar',
                    itemStyle: { color: '#4472C4' }
                }]
            });

            // 3. ä¸šåŠ¡åœºæ™¯åº”ç”¨
            const scenarioData = {};
            responses.forEach(r => {
                if (r.data.scenarios) {
                    const scenarios = Array.isArray(r.data.scenarios) ? r.data.scenarios : [r.data.scenarios];
                    scenarios.forEach(scenario => {
                        scenarioData[scenario] = (scenarioData[scenario] || 0) + 1;
                    });
                }
            });

            const scenarioChart = echarts.init(document.getElementById('scenarioChart'));
            scenarioChart.setOption({
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                xAxis: { type: 'category', data: Object.keys(scenarioData) },
                yAxis: { type: 'value' },
                series: [{
                    data: Object.values(scenarioData),
                    type: 'bar',
                    itemStyle: { color: '#28a745' }
                }]
            });

            // 4. æˆç†Ÿåº¦åˆ†å¸ƒ
            const maturityData = {};
            responses.forEach(r => {
                const maturity = r.data.maturity;
                maturityData[maturity] = (maturityData[maturity] || 0) + 1;
            });

            const maturityChart = echarts.init(document.getElementById('maturityChart'));
            maturityChart.setOption({
                tooltip: { trigger: 'item' },
                legend: { orient: 'vertical', left: 'left' },
                series: [{
                    name: 'æ•°é‡',
                    type: 'pie',
                    radius: '50%',
                    data: Object.entries(maturityData).map(([name, value]) => ({ name, value })),
                    emphasis: { itemStyle: { shadowBlur: 10, shadowOffsetX: 0, shadowColor: 'rgba(0, 0, 0, 0.5)' } }
                }]
            });

            // 5. æŠ•å…¥è§„æ¨¡
            const investmentData = {};
            responses.forEach(r => {
                const investment = r.data.investment;
                investmentData[investment] = (investmentData[investment] || 0) + 1;
            });

            const investmentChart = echarts.init(document.getElementById('investmentChart'));
            investmentChart.setOption({
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                xAxis: { type: 'category', data: Object.keys(investmentData) },
                yAxis: { type: 'value' },
                series: [{
                    data: Object.values(investmentData),
                    type: 'bar',
                    itemStyle: { color: '#ffc107' }
                }]
            });

            // 6. ä¸»è¦éšœç¢
            const obstaclesData = {};
            responses.forEach(r => {
                if (r.data.obstacles) {
                    const obstacles = Array.isArray(r.data.obstacles) ? r.data.obstacles : [r.data.obstacles];
                    obstacles.forEach(obstacle => {
                        obstaclesData[obstacle] = (obstaclesData[obstacle] || 0) + 1;
                    });
                }
            });

            const obstaclesChart = echarts.init(document.getElementById('obstaclesChart'));
            const sortedObstacles = Object.entries(obstaclesData).sort((a, b) => b[1] - a[1]);
            obstaclesChart.setOption({
                tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
                xAxis: { type: 'value' },
                yAxis: { type: 'category', data: sortedObstacles.map(item => item[0]) },
                series: [{
                    data: sortedObstacles.map(item => item[1]),
                    type: 'bar',
                    itemStyle: { color: '#dc3545' }
                }]
            });
        }

        function generateDataTable(responses) {
            const tbody = document.getElementById('dataTableBody');
            tbody.innerHTML = '';

            responses.forEach((response, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${response.data.department}</td>
                    <td>${response.data.position}</td>
                    <td>${response.data.workYears || '-'}</td>
                    <td>${Array.isArray(response.data.aiTechs) ? response.data.aiTechs.join(', ') : response.data.aiTechs || '-'}</td>
                    <td>${Array.isArray(response.data.scenarios) ? response.data.scenarios.join(', ') : response.data.scenarios || '-'}</td>
                    <td>${response.data.maturity || '-'}</td>
                    <td>${response.data.investment || '-'}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // ==================== PDFæŠ¥å‘Šç”Ÿæˆ ====================
        function generatePDFReport() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');

            if (responses.length === 0) {
                alert('è¿˜æ²¡æœ‰é—®å·æ•°æ®ï¼Œè¯·å…ˆå¡«å†™é—®å·');
                return;
            }

            alert('âœ… PDFæŠ¥å‘Šç”ŸæˆåŠŸèƒ½å·²é›†æˆï¼\n\nä½¿ç”¨æµè§ˆå™¨æ‰“å°åŠŸèƒ½ï¼ˆCtrl+Pï¼‰å¯ä»¥å°†åˆ†æé¡µé¢ä¿å­˜ä¸ºPDFã€‚');
        }

        // ==================== æ•°æ®å¯¼å‡º ====================
        function exportToJSON() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');

            if (responses.length === 0) {
                alert('æ²¡æœ‰æ•°æ®å¯å¯¼å‡º');
                return;
            }

            const jsonString = JSON.stringify(responses, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `AIè°ƒæŸ¥é—®å·æ•°æ®_${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
        }

        function exportToCSV() {
            const responses = JSON.parse(localStorage.getItem('surveyResponses') || '[]');

            if (responses.length === 0) {
                alert('æ²¡æœ‰æ•°æ®å¯å¯¼å‡º');
                return;
            }

            const headers = ['åºå·', 'éƒ¨é—¨', 'èŒä½', 'å·¥ä½œå¹´é™', 'AIæŠ€æœ¯', 'åº”ç”¨åœºæ™¯', 'æˆç†Ÿåº¦', 'æŠ•å…¥è§„æ¨¡', 'äººæ‰æ•°é‡', 'æ•ˆç›Š', 'éšœç¢', 'æäº¤æ—¶é—´'];
            let csv = headers.map(h => `"${h}"`).join(',') + '\n';

            responses.forEach((response, index) => {
                const row = [
                    index + 1,
                    response.data.department,
                    response.data.position,
                    response.data.workYears || '',
                    Array.isArray(response.data.aiTechs) ? response.data.aiTechs.join(';') : response.data.aiTechs || '',
                    Array.isArray(response.data.scenarios) ? response.data.scenarios.join(';') : response.data.scenarios || '',
                    response.data.maturity || '',
                    response.data.investment || '',
                    response.data.talentCount || '',
                    Array.isArray(response.data.benefits) ? response.data.benefits.join(';') : response.data.benefits || '',
                    Array.isArray(response.data.obstacles) ? response.data.obstacles.join(';') : response.data.obstacles || '',
                    response.timestamp
                ];
                csv += row.map(cell => `"${cell}"`).join(',') + '\n';
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `AIè°ƒæŸ¥é—®å·æ•°æ®_${new Date().toISOString().slice(0, 10)}.csv`;
            a.click();
        }

        function downloadSampleData() {
            const sampleData = [
                {
                    id: 1,
                    timestamp: new Date().toISOString(),
                    data: {
                        department: "ç»è¥ä¸­å¿ƒ",
                        position: "ä¸­å±‚ç®¡ç†",
                        workYears: "3-5å¹´",
                        aiTechs: ["æœºå™¨å­¦ä¹ ", "é¢„æµ‹åˆ†æ"],
                        scenarios: ["ç¼–å†™ç¨‹åºä»£ç ï¼Œæé«˜ç ”å‘æ•ˆç‡", "å¢åŠ å®¢æˆ·çš„è·å–æ•°é‡ï¼Œåˆ†æå¸‚åœºå’Œé”€å”®æ•°æ®"],
                        maturity: "è¯•ç‚¹é˜¶æ®µ",
                        investment: "50-200ä¸‡",
                        talentCount: "5",
                        benefits: ["ä¸šåŠ¡æ•ˆç‡æå‡", "æˆæœ¬é™ä½"],
                        obstacles: ["æ•°æ®è´¨é‡ä¸æ•°æ®é‡ä¸è¶³", "ä¸“ä¸šäººæ‰ç¼ºä¹"],
                        dataIssues: ["æ•°æ®å­¤å²›"],
                        techIssues: ["ç®—åŠ›èµ„æºä¸è¶³"],
                        capabilities: ["æ•°æ®é‡‡é›†ä¸å¤„ç†", "AIç®—æ³•ç ”å‘"],
                        industryOutlook: "4",
                        competitivePosition: "ä¸æˆ‘ä»¬ç›¸å½“"
                    }
                },
                {
                    id: 2,
                    timestamp: new Date().toISOString(),
                    data: {
                        department: "é›†æˆä¸šåŠ¡ä¸­å¿ƒ",
                        position: "æŠ€æœ¯äººå‘˜",
                        workYears: "1-3å¹´",
                        aiTechs: ["æœºå™¨å­¦ä¹ ", "è‡ªç„¶è¯­è¨€å¤„ç†(NLP)"],
                        scenarios: ["æé«˜è´¨é‡ç®¡ç†æ°´å¹³", "å¢åŠ ç®¡ç†è€…å†³ç­–çš„é€æ˜åº¦å’Œå‡†ç¡®æ€§"],
                        maturity: "åº”ç”¨é˜¶æ®µ",
                        investment: "200-500ä¸‡",
                        talentCount: "12",
                        benefits: ["å†³ç­–è´¨é‡æå‡", "é£é™©é˜²æ§å¢å¼º"],
                        obstacles: ["ç¼ºä¹ç»Ÿä¸€çš„AIæˆ˜ç•¥è§„åˆ’"],
                        dataIssues: ["æ•°æ®æ ‡å‡†ä¸ç»Ÿä¸€"],
                        techIssues: ["æ¨¡å‹ç²¾åº¦ä¸ç†æƒ³"],
                        capabilities: ["AIåº”ç”¨å¼€å‘", "äººæ‰å¼•è¿›ä¸åŸ¹å…»"],
                        industryOutlook: "2",
                        competitivePosition: "è½åäºæˆ‘ä»¬"
                    }
                },
                {
                    id: 3,
                    timestamp: new Date().toISOString(),
                    data: {
                        department: "äº§å“ä¸­å¿ƒ",
                        position: "ä¸šåŠ¡äººå‘˜",
                        workYears: "1-3å¹´",
                        aiTechs: ["æœºå™¨å­¦ä¹ "],
                        scenarios: ["é™ä½é‡‡è´­æˆæœ¬"],
                        maturity: "æ¢ç´¢é˜¶æ®µ",
                        investment: "æœªæŠ•å…¥",
                        talentCount: "2",
                        benefits: [],
                        obstacles: ["èµ„é‡‘æŠ•å…¥ä¸è¶³", "æŠ€æœ¯åŸºç¡€è®¾æ–½ä¸å®Œå–„"],
                        dataIssues: ["æ•°æ®è´¨é‡å‚å·®"],
                        techIssues: ["ç¼ºä¹è‡ªä¸»ç ”å‘èƒ½åŠ›"],
                        capabilities: ["æ•°æ®é‡‡é›†ä¸å¤„ç†"],
                        industryOutlook: "3",
                        competitivePosition: "é¢†å…ˆäºæˆ‘ä»¬"
                    }
                }
            ];

            localStorage.removeItem('surveyResponses');
            clearAllCharts();
            
            document.getElementById('totalResponses').textContent = '0';
            document.getElementById('departmentCount').textContent = '0';
            document.getElementById('aiAdoptionRate').textContent = '0%';
            document.getElementById('avgMaturity').textContent = '0';
            document.getElementById('dataTableBody').innerHTML = '';
            
            localStorage.setItem('surveyResponses', JSON.stringify(sampleData));
            
            updateHeaderStats();
            refreshAnalysis();
            
            showLoadSampleMessage();
        }

        // ==================== åˆ†äº«é—®å· ====================
        let qrcodeInstance = null;

        function autoDetectUrl() {
            const currentUrl = window.location.href;
            document.getElementById('shareUrl').value = currentUrl;
        }

        function generateShareQRCode() {
            const url = document.getElementById('shareUrl').value.trim();

            if (!url) {
                alert('è¯·è¾“å…¥é—®å·é“¾æ¥');
                return;
            }

            const qrcodeContainer = document.getElementById('qrcode');
            qrcodeContainer.innerHTML = '';

            qrcodeInstance = new QRCode(qrcodeContainer, {
                text: url,
                width: 300,
                height: 300,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });

            document.getElementById('shareUrlDisplay').textContent = url;
            document.getElementById('shareResult').style.display = 'block';
        }

        function generateShareLink() {
            const url = document.getElementById('shareUrl').value.trim();

            if (!url) {
                alert('è¯·è¾“å…¥é—®å·é“¾æ¥');
                return;
            }

            const shortUrl = `https://bit.ly/${generateRandomString(6)}`;
            
            document.getElementById('shareUrlDisplay').textContent = url;
            document.getElementById('shareShortDisplay').textContent = shortUrl;
            document.getElementById('shareShortDisplay').style.display = 'block';
            document.getElementById('copyShortBtn').style.display = 'block';
            document.getElementById('shareResult').style.display = 'block';
        }

        function downloadShareQRCode() {
            const qrcodeCanvas = document.querySelector('#qrcode canvas');
            if (!qrcodeCanvas) {
                alert('è¯·å…ˆç”ŸæˆäºŒç»´ç ');
                return;
            }

            const link = document.createElement('a');
            link.href = qrcodeCanvas.toDataURL('image/png');
            link.download = `survey_qrcode_${new Date().getTime()}.png`;
            link.click();
        }

        function printShareQRCode() {
            const qrcodeCanvas = document.querySelector('#qrcode canvas');
            if (!qrcodeCanvas) {
                alert('è¯·å…ˆç”ŸæˆäºŒç»´ç ');
                return;
            }

            const printWindow = window.open();
            printWindow.document.write('<img src="' + qrc